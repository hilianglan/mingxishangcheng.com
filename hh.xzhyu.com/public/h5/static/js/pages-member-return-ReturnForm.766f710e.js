(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-return-ReturnForm"],{"0177":function(e,t,i){"use strict";i.r(t);var n=i("1290"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},1290:function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("14d9");var o=i("9c03"),a=n(i("c657")),r=n(i("19543")),s=n(i("0dfd")),u=i("7744"),d=n(i("d868")),l={components:{TitleHeader:a.default,MemberBase:r.default,flexLine:d.default,tuiPictureCropper:s.default},name:"MemberReturnForm",data:function(){return{navHeight:0,screenWidth:0,screenHeight:0,cropperOption:{img:"",canMove:!1,autoCrop:!0,autoCropWidth:100,autoCropHeight:100,maxImgSize:500,outputType:"png"},showCrop:!1,cropType:"",type:0,title:"退款",order_id:0,order_goods_id:0,image:[],buyer_message:"",file_value:{},reason_id:"",reason_name:"",reason_list:{},reason_options:[],refund_amount:"",goods_num:"",goods:{}}},mounted:function(){var e=uni.getSystemInfoSync();this.screenWidth=e.windowWidth,this.screenHeight=e.windowHeight},computed:{fontSize:function(){return(0,o.getFontSize)()}},onLoad:function(e){var t=this;this.type=e.type,this.title=2==e.type?"退货":"退款",this.order_id=e.order_id,this.order_goods_id=e.order_goods_id,(0,u.getCommonData)(this.order_id,this.order_goods_id).then((function(e){t.goods=e.result.goods;var i=e.result.reason_list;for(var n in i)t.reason_options.push({label:i[n].reason_info,value:i[n].reason_id+""}),t.reason_list[i[n].reason_id+""]=i[n].reason_info,""===t.reason_id&&(t.reason_id=i[n].reason_id+"")})).catch((function(e){uni.showToast({icon:"none",title:e.message})}))},watch:{reason_id:function(e){this.reason_name=this.reason_list[e],this.hidePopup("popupReason")}},methods:{radioChange:function(e){this.reason_id=e.detail.value},showPopup:function(e){this.$refs[e].open()},hidePopup:function(e){this.$refs[e].close()},goBack:function(){uni.navigateBack({delta:1})},submitInformation:function(){var e=this;if(this.refund_amount){var t=[];for(var i in this.file_value)t.push(this.file_value[i]);(0,u.addRefund)(this.type,this.order_id,this.order_goods_id,this.refund_amount,this.goods_num,this.reason_id,this.buyer_message,t).then((function(t){uni.showToast({icon:"none",title:t.message}),2==e.type?uni.navigateTo({url:"/pages/member/return/ReturnList"}):uni.navigateTo({url:"/pages/member/refund/RefundList"})})).catch((function(e){uni.showToast({icon:"none",title:e.message})}))}else uni.showToast({icon:"none",title:"请填写退款金额"})},useCrop:function(e){var t=this,i=this.cropType,n={filePath:e.url,name:"refund_pic"};(0,u.uploadRefundImage)(n).then((function(e){t.file_value[i]=e.result.file_name,t.image[i]=[{name:i,extname:"jpg",url:e.result.pic}],t.cropperOption.imgUrl="",t.$forceUpdate(),uni.hideLoading()})).catch((function(e){uni.showToast({icon:"none",title:e.message}),uni.hideLoading(),this.cropperOption.imgUrl="",this.$forceUpdate()}))},deleteRefundImage:function(e){var t=e.tempFile,i=t.uuid;delete this.file_value[i]},cropReady:function(){this.cropperOption.img=this.cropperOption.imgUrl},cropBack:function(){this.cropperOption.imgUrl="",this.$forceUpdate()},uploadRefundImage:function(e){var t=e.tempFiles[0];this.cropType=t.uuid,this.cropperOption.imgUrl=t.path,this.cropperOption.autoCropWidth=uni.getSystemInfoSync().windowWidth,this.cropperOption.autoCropHeight=uni.getSystemInfoSync().windowWidth,this.cropperOption.maxImgSize=uni.getSystemInfoSync().windowHeight-40,this.$forceUpdate()}}};t.default=l},"511c":function(e,t,i){"use strict";var n=i("a582"),o=i.n(n);o.a},7744:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.uploadRefundImage=t.getRefundList=t.getRefundInfo=t.getCommonData=t.addRefundAll=t.addRefund=void 0;var n=i("6e6d");t.getRefundList=function(e){return(0,n.requestApi)("/Memberrefund/get_refund_list","POST",{page:e.page,per_page:e.per_page},"member")};t.getRefundInfo=function(e){return(0,n.requestApi)("/Memberrefund/get_refund_info","POST",{refund_id:e},"member")};t.addRefundAll=function(e,t,i){return(0,n.requestApi)("/Memberrefund/refund_all_post","POST",{order_id:e,buyer_message:t,refund_pic:i},"member")};t.addRefund=function(e,t,i,o,a,r,s,u){return(0,n.requestApi)("/Memberrefund/refund_post","POST",{refund_type:e,order_id:t,order_goods_id:i,refund_amount:o,goods_num:a,reason_id:r,buyer_message:s,refund_pic:u},"member")};t.uploadRefundImage=function(e){return(0,n.requestApi)("/Memberrefund/upload_pic","POST",e,"member",!0)};t.getCommonData=function(e,t){return(0,n.requestApi)("/Memberrefund/refund_form","POST",{order_id:e,order_goods_id:t},"member")}},a582:function(e,t,i){var n=i("f224");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("4f06").default;o("f23830a0",n,!0,{sourceMap:!1,shadowMode:!1})},bee8:function(e,t,i){"use strict";i.r(t);var n=i("c586"),o=i("0177");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("511c");var r=i("f0c5"),s=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"bd78c6fa",null,!1,n["a"],void 0);t["default"]=s.exports},c586:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={pageMeta:i("6d42").default,uniNavBar:i("10ee").default,uniFilePicker:i("f99d").default,uniPopup:i("cabf").default},o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("page-meta",{attrs:{"root-font-size":e.fontSize+"px"}}),i("member-base",{attrs:{show:!1}},[i("v-uni-view",{staticClass:"div member-information"},[i("v-uni-view",{staticClass:"div common-header-wrap"},[i("v-uni-view",{style:"height:"+e.navHeight+"px"}),i("v-uni-view",{staticClass:"common-header-holder"}),i("v-uni-view",{staticClass:"common-header-fixed"},[i("title-header"),i("uni-nav-bar",{staticClass:"common-header",attrs:{title:"新增"+e.title,"left-icon":"back"},on:{clickLeft:function(t){arguments[0]=t=e.$handleEvent(t),e.goBack()}}})],1)],1),i("v-uni-view",{staticClass:"div form"},[i("v-uni-view",{staticClass:"div",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showPopup("popupReason")}}},[i("flex-line",{staticClass:"menu-item",attrs:{"is-link":!0,"show-border":!0}},[i("v-uni-text",{staticClass:"span line-name"},[e._v(e._s(e.title+"原因"))]),i("v-uni-text",{staticClass:"span",attrs:{slot:"right"},slot:"right"},[e._v(e._s(e.reason_name))])],1)],1),i("flex-line",{staticClass:"field-line menu-item",attrs:{"show-border":!0}},[i("v-uni-text",{staticClass:"span field-name"},[e._v("退款金额")]),i("v-uni-view",{staticClass:"div field-line-right",attrs:{slot:"right"},slot:"right"},[i("v-uni-input",{staticClass:"field-input",attrs:{placeholder:"最多可退金额"+e.goods.goods_pay_price+"元"},model:{value:e.refund_amount,callback:function(t){e.refund_amount=t},expression:"refund_amount"}})],1)],1),2==e.type?i("flex-line",{staticClass:"field-line menu-item",attrs:{"show-border":!0}},[i("v-uni-text",{staticClass:"span field-name"},[e._v("退货数量")]),i("v-uni-view",{staticClass:"div field-line-right",attrs:{slot:"right"},slot:"right"},[i("v-uni-input",{staticClass:"field-input",attrs:{placeholder:"最多可退数量"+e.goods.goods_num+"件"},model:{value:e.goods_num,callback:function(t){e.goods_num=t},expression:"goods_num"}})],1)],1):e._e(),i("flex-line",{staticClass:"field-line menu-item",attrs:{"show-border":!0}},[i("v-uni-text",{staticClass:"span field-name"},[e._v(e._s(e.title+"说明"))]),i("v-uni-view",{staticClass:"div field-line-right",attrs:{slot:"right"},slot:"right"},[i("v-uni-input",{staticClass:"field-input",model:{value:e.buyer_message,callback:function(t){e.buyer_message=t},expression:"buyer_message"}})],1)],1),i("flex-line",{staticClass:"menu-item"},[i("v-uni-text",{staticClass:"span line-name"},[e._v(e._s(e.title+"凭证"))])],1),i("v-uni-view",{staticClass:"div image-wrapper"},[i("v-uni-view",{staticClass:"div user-avatar"},[i("uni-file-picker",{attrs:{fileMediatype:"image",mode:"grid",limit:3,"auto-upload":!1},on:{select:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadRefundImage.apply(void 0,arguments)},delete:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteRefundImage.apply(void 0,arguments)}},model:{value:e.image,callback:function(t){e.image=t},expression:"image"}})],1)],1),i("v-uni-view",{staticClass:"div pt-10 pb-10"},[i("v-uni-view",{staticClass:"div common-btn ds-button-large",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submitInformation.apply(void 0,arguments)}}},[e._v("保存")])],1)],1),i("uni-popup",{ref:"popupReason",attrs:{"background-color":"#fff",type:"right"}},[i("v-uni-view",{staticClass:"common-popup-wrapper",style:"width:"+e.screenWidth+"px"},[i("v-uni-view",{staticClass:"div common-header-wrap"},[i("v-uni-view",{style:"height:"+e.navHeight+"px"}),i("v-uni-view",{staticClass:"common-header-holder"}),i("v-uni-view",{staticClass:"common-header-fixed"},[i("title-header"),i("uni-nav-bar",{staticClass:"common-header",attrs:{title:e.title+"原因","left-icon":"back"},on:{clickLeft:function(t){arguments[0]=t=e.$handleEvent(t),e.hidePopup("popupReason")}}})],1)],1),i("v-uni-view",{staticClass:"div common-popup-content"},[i("v-uni-scroll-view",{staticStyle:{position:"absolute",top:"0",right:"0",left:"0",bottom:"0"},attrs:{"scroll-y":"true"}},[i("v-uni-radio-group",{staticClass:"radio-wrapper",on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.radioChange.apply(void 0,arguments)}}},e._l(e.reason_options,(function(t,n){return i("v-uni-view",{key:n,staticClass:"radio-item"},[i("v-uni-radio",{attrs:{value:t.value,checked:e.reason_id==t.value}}),i("v-uni-text",[e._v(e._s(t.label))])],1)})),1)],1)],1)],1)],1),e.cropperOption.imgUrl?i("tui-picture-cropper",{attrs:{width:e.cropperOption.autoCropWidth,height:e.cropperOption.autoCropHeight,imageUrl:e.cropperOption.img},on:{ready:function(t){arguments[0]=t=e.$handleEvent(t),e.cropReady.apply(void 0,arguments)},cropper:function(t){arguments[0]=t=e.$handleEvent(t),e.useCrop.apply(void 0,arguments)},back:function(t){arguments[0]=t=e.$handleEvent(t),e.cropBack.apply(void 0,arguments)}}}):e._e()],1)],1)],1)},a=[]},f224:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.common-header .btn[data-v-bd78c6fa]{background:#000;color:#fff;box-shadow:0 2px 4px #d2d2d2}.form[data-v-bd78c6fa]{background:#fff;padding:0 .6rem}.member-information[data-v-bd78c6fa]{background:#fff}.radio-wrapper[data-v-bd78c6fa]{display:block;padding:0 .6rem}.radio-wrapper .radio-item[data-v-bd78c6fa]{padding:.5rem 0;border-bottom:1px dashed #f5f5f5}',""]),e.exports=t}}]);